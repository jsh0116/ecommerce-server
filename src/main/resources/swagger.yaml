openapi: 3.0.3
info:
  title: ì˜ë¥˜ ì´ì»¤ë¨¸ìŠ¤ API
  description: |
    ## ğŸ“– ê°œìš”
    ì˜ë¥˜ ì´ì»¤ë¨¸ìŠ¤ í”Œë«í¼ì˜ RESTful API ë¬¸ì„œì…ë‹ˆë‹¤.
    
    ## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥
    - ğŸ” ìƒí’ˆ ê²€ìƒ‰ ë° í•„í„°ë§ (ë‹¤ì¤‘ ìƒ‰ìƒ/ì‚¬ì´ì¦ˆ)
    - ğŸ“¦ ì‹¤ì‹œê°„ ì¬ê³  ê´€ë¦¬ (ë™ì‹œì„± ì œì–´)
    - ğŸ›’ ì¥ë°”êµ¬ë‹ˆ ë° ì£¼ë¬¸ ì²˜ë¦¬
    - ğŸ’³ ê²°ì œ ë° ì •ì‚°
    - ğŸŸï¸ ì¿ í° ë° í¬ì¸íŠ¸ ì‹œìŠ¤í…œ
    - ğŸšš ë°°ì†¡ ì¶”ì 
    - ğŸ”„ ë°˜í’ˆ ë° êµí™˜
    - â­ ë¦¬ë·° ì‹œìŠ¤í…œ
    
    ## ğŸ” ì¸ì¦
    ëŒ€ë¶€ë¶„ì˜ APIëŠ” JWT Bearer Token ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.
    
    ## âš¡ Rate Limiting
    - ì¸ì¦ëœ ì‚¬ìš©ì: 1000 req/hour
    - ë¹„ì¸ì¦ ì‚¬ìš©ì: 100 req/hour
    
    ## ğŸ“‹ ì£¼ìš” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    ### ì¬ê³  ê´€ë¦¬
    - ì¬ê³  ì°¨ê° ì‹œì : **ê²°ì œ ìŠ¹ì¸ ì‹œ**
    - ì¬ê³  ì˜ˆì•½: ì£¼ë¬¸ ìƒì„± ì‹œ 15ë¶„ TTL
    - ë™ì‹œì„± ì œì–´: Pessimistic Lock + Redis ë¶„ì‚° ë½
    
    ### ì£¼ë¬¸ í”„ë¡œì„¸ìŠ¤
    1. ì¥ë°”êµ¬ë‹ˆ ì¶”ê°€ â†’ ì¬ê³  ì¡°íšŒë§Œ
    2. ì£¼ë¬¸ ìƒì„± â†’ ì¬ê³  ì˜ˆì•½ (15ë¶„)
    3. ê²°ì œ ìŠ¹ì¸ â†’ ì‹¤ì¬ê³  ì°¨ê°
    4. ê²°ì œ ì‹¤íŒ¨ â†’ ì˜ˆì•½ í•´ì œ
    
    ### ë°˜í’ˆ/êµí™˜
    - ë°˜í’ˆ ê°€ëŠ¥ ê¸°ê°„: ë°°ì†¡ ì™„ë£Œ í›„ 7ì¼
    - ë‹¨ìˆœ ë³€ì‹¬: ê³ ê° ë¶€ë‹´ 6,000ì›
    - ë¶ˆëŸ‰/ì˜¤ë°°ì†¡: ë¬´ë£Œ

  version: 1.0.0
  contact:
    name: API Support
    email: api@fashionstore.com
    url: https://www.fashionstore.com/support
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: https://www.fashionstore.com/terms
  x-critical-features: |
    **âš ï¸ P0 Critical Features (ë°˜ë“œì‹œ êµ¬í˜„):**

    1. **Idempotency Key** (ë©±ë“±ì„± í‚¤)
       - ì¤‘ë³µ ê²°ì œ ë°©ì§€
       - ìš”ì²­ í—¤ë”: `Idempotency-Key: {UUID}`
       - ê²°ì œ ìš”ì²­ì— í•„ìˆ˜

    2. **Saga Pattern** (ë¶„ì‚° íŠ¸ëœì­ì…˜)
       - ê²°ì œ + ì¬ê³  ì°¨ê°ì˜ ì›ìì„± ë³´ì¥
       - ë³´ìƒ íŠ¸ëœì­ì…˜ êµ¬í˜„
       - ê²°ì œ ì‹¤íŒ¨ ì‹œ ìë™ í™˜ë¶ˆ

    3. **Webhook ë³´ì•ˆ** (PGì‚¬ Webhook)
       - HMAC-SHA256 ì„œëª… ê²€ì¦
       - Nonce + Timestamp ê²€ì¦
       - Event ID ê¸°ë°˜ ë©±ë“±ì„±

servers:
  - url: https://api.fashionstore.com/v1
    description: Production ì„œë²„
  - url: https://api-staging.fashionstore.com/v1
    description: Staging ì„œë²„
  - url: http://localhost:3000/v1
    description: Local ê°œë°œ ì„œë²„

tags:
  - name: Products
    description: ìƒí’ˆ ê´€ë¦¬
    externalDocs:
      description: ìƒí’ˆ ê´€ë¦¬ ê°€ì´ë“œ
      url: https://docs.fashionstore.com/products
  - name: Cart
    description: ì¥ë°”êµ¬ë‹ˆ
  - name: Orders
    description: ì£¼ë¬¸ ê´€ë¦¬
  - name: Payments
    description: ê²°ì œ ì²˜ë¦¬
  - name: Coupons
    description: ì¿ í° ì‹œìŠ¤í…œ
  - name: Points
    description: í¬ì¸íŠ¸ ê´€ë¦¬
  - name: Inventory
    description: ì¬ê³  ê´€ë¦¬
  - name: Shipments
    description: ë°°ì†¡ ì¶”ì 
  - name: Returns
    description: ë°˜í’ˆ ì²˜ë¦¬
  - name: Exchanges
    description: êµí™˜ ì²˜ë¦¬
  - name: Reviews
    description: ë¦¬ë·° ì‹œìŠ¤í…œ
  - name: Webhooks
    description: Webhook ìˆ˜ì‹  (ì™¸ë¶€ ì„œë¹„ìŠ¤ â†’ ìš°ë¦¬ ì„œë²„)
  - name: Users
    description: ì‚¬ìš©ì ê´€ë¦¬

paths:
  # ============================================
  # Products API
  # ============================================
  /products:
    get:
      tags:
        - Products
      summary: ìƒí’ˆ ëª©ë¡ ì¡°íšŒ
      description: |
        ìƒí’ˆì„ ê²€ìƒ‰í•˜ê³  í•„í„°ë§í•©ë‹ˆë‹¤.
        
        ### í•„í„°ë§ ì˜ˆì‹œ
        - ì¹´í…Œê³ ë¦¬ í•„í„°: `?category=jacket`
        - ë‹¤ì¤‘ ìƒ‰ìƒ: `?color=black&color=navy`
        - ê°€ê²© ë²”ìœ„: `?minPrice=50000&maxPrice=100000`
        - ì¬ê³  ìˆëŠ” ìƒí’ˆë§Œ: `?inStock=true`
        
        ### ì •ë ¬ ì˜ˆì‹œ
        - ê°€ê²© ë‚®ì€ìˆœ: `?sort=price`
        - ê°€ê²© ë†’ì€ìˆœ: `?sort=-price`
        - ìµœì‹ ìˆœ: `?sort=-createdAt`
        - ì¸ê¸°ìˆœ: `?sort=popularity`
      operationId: listProducts
      parameters:
        - $ref: '#/components/parameters/CategoryFilter'
        - $ref: '#/components/parameters/BrandFilter'
        - $ref: '#/components/parameters/ColorFilter'
        - $ref: '#/components/parameters/SizeFilter'
        - $ref: '#/components/parameters/MinPrice'
        - $ref: '#/components/parameters/MaxPrice'
        - $ref: '#/components/parameters/InStock'
        - $ref: '#/components/parameters/Sort'
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Product'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
              example:
                data:
                  - id: "prod_123"
                    name: "ìŠ¬ë¦¼í• ì²­ë°”ì§€"
                    brand: "LEVI'S"
                    category: "pants"
                    basePrice: 89000
                    salePrice: 79000
                    discountRate: 11
                    images:
                      - "https://cdn.fashionstore.com/prod_123_1.jpg"
                      - "https://cdn.fashionstore.com/prod_123_2.jpg"
                    variantCount: 12
                    rating: 4.5
                    reviewCount: 128
                    tags: ["ë² ìŠ¤íŠ¸", "ì‹ ìƒí’ˆ"]
                pagination:
                  page: 1
                  limit: 20
                  total: 150
                  totalPages: 8
        '400':
          $ref: '#/components/responses/BadRequest'
        default:
          $ref: '#/components/responses/UnexpectedError'

  /products/search:
    get:
      tags:
        - Products
      summary: ìƒí’ˆ ê²€ìƒ‰
      description: í‚¤ì›Œë“œë¡œ ìƒí’ˆì„ ê²€ìƒ‰í•©ë‹ˆë‹¤. Elasticsearch ê¸°ë°˜.
      operationId: searchProducts
      parameters:
        - name: q
          in: query
          required: true
          schema:
            type: string
          description: ê²€ìƒ‰ í‚¤ì›Œë“œ
          example: "ì²­ë°”ì§€"
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: ê²€ìƒ‰ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Product'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
                  suggestions:
                    type: array
                    items:
                      type: string
                    description: ì¶”ì²œ ê²€ìƒ‰ì–´
        '400':
          $ref: '#/components/responses/BadRequest'

  /products/{productId}:
    get:
      tags:
        - Products
      summary: ìƒí’ˆ ìƒì„¸ ì¡°íšŒ
      description: íŠ¹ì • ìƒí’ˆì˜ ìƒì„¸ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: getProduct
      parameters:
        - name: productId
          in: path
          required: true
          schema:
            type: string
          description: ìƒí’ˆ ID
          example: "prod_123"
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductDetail'
              example:
                id: "prod_123"
                name: "ìŠ¬ë¦¼í• ì²­ë°”ì§€"
                brand: "LEVI'S"
                category: "pants"
                description: "í´ë˜ì‹í•œ í•ì˜ ì²­ë°”ì§€ì…ë‹ˆë‹¤."
                basePrice: 89000
                salePrice: 79000
                discountRate: 11
                material: "ë©´ 98%, ìŠ¤íŒë±ìŠ¤ 2%"
                careInstructions:
                  - "ë‹¨ë… ì„¸íƒ"
                  - "ì°¬ë¬¼ ì„¸íƒ"
                  - "ê±´ì¡°ê¸° ì‚¬ìš© ê¸ˆì§€"
                images:
                  - "https://cdn.fashionstore.com/prod_123_1.jpg"
                  - "https://cdn.fashionstore.com/prod_123_2.jpg"
                variants:
                  - id: "var_456"
                    sku: "LEVI-501-BLK-32-REG"
                    color: "black"
                    colorHex: "#000000"
                    size: "32"
                    length: "regular"
                    stock: 15
                    stockStatus: "IN_STOCK"
                sizeGuide:
                  brand: "LEVI'S"
                  category: "pants"
                  measurements:
                    - size: "32"
                      waist: 82
                      hip: 98
                      length: 108
                rating: 4.5
                reviewCount: 128
        '404':
          $ref: '#/components/responses/NotFound'
        default:
          $ref: '#/components/responses/UnexpectedError'

  /products/{productId}/variants:
    get:
      tags:
        - Products
      summary: ìƒí’ˆ ë³€ëŸ‰ ëª©ë¡ ì¡°íšŒ
      description: íŠ¹ì • ìƒí’ˆì˜ ëª¨ë“  SKU(ìƒ‰ìƒ/ì‚¬ì´ì¦ˆ ì¡°í•©)ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: listProductVariants
      parameters:
        - name: productId
          in: path
          required: true
          schema:
            type: string
          example: "prod_123"
        - name: color
          in: query
          schema:
            type: string
          description: ìƒ‰ìƒ í•„í„°
        - name: size
          in: query
          schema:
            type: string
          description: ì‚¬ì´ì¦ˆ í•„í„°
        - name: inStock
          in: query
          schema:
            type: boolean
          description: ì¬ê³  ìˆëŠ” ë³€ëŸ‰ë§Œ
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProductVariant'
              example:
                - id: "var_456"
                  sku: "LEVI-501-BLK-32-REG"
                  color: "black"
                  colorHex: "#000000"
                  size: "32"
                  length: "regular"
                  price: 79000
                  stock: 15
                  stockStatus: "IN_STOCK"
                - id: "var_457"
                  sku: "LEVI-501-BLK-34-REG"
                  color: "black"
                  colorHex: "#000000"
                  size: "34"
                  length: "regular"
                  price: 79000
                  stock: 3
                  stockStatus: "LOW_STOCK"
        '404':
          $ref: '#/components/responses/NotFound'

  /skus/{sku}:
    get:
      tags:
        - Products
      summary: SKU ì½”ë“œë¡œ ìƒí’ˆ ì¡°íšŒ
      description: SKU ì½”ë“œë¡œ ì§ì ‘ ìƒí’ˆ ë³€ëŸ‰ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: getProductBySku
      parameters:
        - name: sku
          in: path
          required: true
          schema:
            type: string
          example: "LEVI-501-BLK-32-REG"
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductVariant'
        '404':
          $ref: '#/components/responses/NotFound'

  # ============================================
  # Cart API
  # ============================================
  /cart:
    get:
      tags:
        - Cart
      summary: ì¥ë°”êµ¬ë‹ˆ ì¡°íšŒ
      description: í˜„ì¬ ì‚¬ìš©ìì˜ ì¥ë°”êµ¬ë‹ˆë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: getCart
      security:
        - bearerAuth: []
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cart'
              example:
                items:
                  - id: "cart_item_1"
                    product:
                      id: "prod_123"
                      name: "ìŠ¬ë¦¼í• ì²­ë°”ì§€"
                      brand: "LEVI'S"
                    variant:
                      id: "var_456"
                      sku: "LEVI-501-BLK-32-REG"
                      color: "black"
                      size: "32"
                    quantity: 2
                    price: 79000
                    subtotal: 158000
                summary:
                  itemCount: 3
                  subtotal: 267000
                  estimatedShipping: 3000
                  estimatedTotal: 270000
        '401':
          $ref: '#/components/responses/Unauthorized'

    delete:
      tags:
        - Cart
      summary: ì¥ë°”êµ¬ë‹ˆ ì „ì²´ ë¹„ìš°ê¸°
      description: ì¥ë°”êµ¬ë‹ˆì˜ ëª¨ë“  í•­ëª©ì„ ì‚­ì œí•©ë‹ˆë‹¤.
      operationId: clearCart
      security:
        - bearerAuth: []
      responses:
        '204':
          description: ì„±ê³µ
        '401':
          $ref: '#/components/responses/Unauthorized'

  /cart/items:
    post:
      tags:
        - Cart
      summary: ì¥ë°”êµ¬ë‹ˆì— ìƒí’ˆ ì¶”ê°€
      description: |
        ì¥ë°”êµ¬ë‹ˆì— ìƒí’ˆì„ ì¶”ê°€í•©ë‹ˆë‹¤.
        
        **ì£¼ì˜ì‚¬í•­:**
        - ì¬ê³ ê°€ ë¶€ì¡±í•˜ë©´ 409 ì—ëŸ¬ ë°˜í™˜
        - ì´ë¯¸ ì¥ë°”êµ¬ë‹ˆì— ìˆëŠ” ìƒí’ˆì€ ìˆ˜ëŸ‰ ì¦ê°€
      operationId: addToCart
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - variantId
                - quantity
              properties:
                variantId:
                  type: string
                  description: ë³€ëŸ‰ ID (ë˜ëŠ” SKU ì½”ë“œ)
                quantity:
                  type: integer
                  minimum: 1
                  maximum: 99
            example:
              variantId: "var_456"
              quantity: 2
      responses:
        '201':
          description: ì¶”ê°€ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartItem'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '409':
          description: ì¬ê³  ë¶€ì¡±
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "INSUFFICIENT_STOCK"
                message: "ì¬ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. í˜„ì¬ ì¬ê³ : 3ê°œ"
                details:
                  availableStock: 3

  /cart/items/{itemId}:
    patch:
      tags:
        - Cart
      summary: ì¥ë°”êµ¬ë‹ˆ í•­ëª© ìˆ˜ëŸ‰ ë³€ê²½
      description: ì¥ë°”êµ¬ë‹ˆ í•­ëª©ì˜ ìˆ˜ëŸ‰ì„ ë³€ê²½í•©ë‹ˆë‹¤.
      operationId: updateCartItem
      security:
        - bearerAuth: []
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            type: string
          example: "cart_item_1"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - quantity
              properties:
                quantity:
                  type: integer
                  minimum: 1
                  maximum: 99
            example:
              quantity: 3
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartItem'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'

    delete:
      tags:
        - Cart
      summary: ì¥ë°”êµ¬ë‹ˆ í•­ëª© ì‚­ì œ
      description: ì¥ë°”êµ¬ë‹ˆì—ì„œ íŠ¹ì • í•­ëª©ì„ ì‚­ì œí•©ë‹ˆë‹¤.
      operationId: removeFromCart
      security:
        - bearerAuth: []
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            type: string
      responses:
        '204':
          description: ì‚­ì œ ì„±ê³µ
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  # ============================================
  # Orders API
  # ============================================
  /orders:
    get:
      tags:
        - Orders
      summary: ì£¼ë¬¸ ëª©ë¡ ì¡°íšŒ
      description: ì‚¬ìš©ìì˜ ì£¼ë¬¸ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: listOrders
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/OrderStatus'
          description: ì£¼ë¬¸ ìƒíƒœ í•„í„°
        - name: startDate
          in: query
          schema:
            type: string
            format: date
          description: ì‹œì‘ ë‚ ì§œ
        - name: endDate
          in: query
          schema:
            type: string
            format: date
          description: ì¢…ë£Œ ë‚ ì§œ
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Order'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '401':
          $ref: '#/components/responses/Unauthorized'

    post:
      tags:
        - Orders
      summary: ì£¼ë¬¸ ìƒì„±
      description: |
        ì£¼ë¬¸ì„ ìƒì„±í•©ë‹ˆë‹¤.

        **í”„ë¡œì„¸ìŠ¤:**
        1. ì¬ê³  ì˜ˆì•½ (15ë¶„ TTL)
        2. ë°°ì†¡ë¹„ ê³„ì‚° [P0]
        3. ì¿ í°/í¬ì¸íŠ¸ ì ìš©
        4. ìµœì¢… ê¸ˆì•¡ ê³„ì‚°
        5. ì£¼ë¬¸ ìƒì„± (PENDING_PAYMENT ìƒíƒœ)

        **[P0] ë°°ì†¡ë¹„ ê³„ì‚° ê·œì¹™ (ìµœìš°ì„ ìˆœ):**

        1ï¸âƒ£ **VIP íšŒì› í™•ì¸** (ìµœìš°ì„ )
           - VIP íšŒì›: **ë¬´ë£Œë°°ì†¡** (ëª¨ë“  ìƒí’ˆ, ëª¨ë“  ì§€ì—­)

        2ï¸âƒ£ **ê¸°ë³¸ ë°°ì†¡ë¹„**
           - ê¸°ë³¸ê°’: **3,000ì›**
           - ë¬´ë£Œë°°ì†¡ ê¸°ì¤€: **ì£¼ë¬¸ ê¸ˆì•¡ 30,000ì› ì´ìƒ**

        3ï¸âƒ£ **ì§€ì—­ í• ì¦ë£Œ**
           - ì œì£¼ë„: **+3,000ì›** ì¶”ê°€
           - ë„ì„œì‚°ê°„: **+3,000ì›** ì¶”ê°€
           - ë°°ì†¡ ë¶ˆê°€ ì§€ì—­: ì„ íƒ ë¶ˆê°€ (ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì œê±°)

        **ë°°ì†¡ë¹„ ê³„ì‚° ì˜ˆì‹œ:**
        - ì¼ë°˜íšŒì›, ì£¼ë¬¸ì•¡ 50,000ì›, ì„œìš¸ â†’ **ë¬´ë£Œ** (30K ì´ìƒ)
        - ì¼ë°˜íšŒì›, ì£¼ë¬¸ì•¡ 25,000ì›, ì„œìš¸ â†’ **3,000ì›** (ê¸°ë³¸)
        - ì¼ë°˜íšŒì›, ì£¼ë¬¸ì•¡ 25,000ì›, ì œì£¼ â†’ **6,000ì›** (3K + 3K í• ì¦)
        - VIPíšŒì›, ì£¼ë¬¸ì•¡ 10,000ì›, ì œì£¼ â†’ **ë¬´ë£Œ** (VIP)

        **ì£¼ì˜ì‚¬í•­:**
        - 15ë¶„ ë‚´ì— ê²°ì œë¥¼ ì™„ë£Œí•´ì•¼ í•©ë‹ˆë‹¤.
        - ì‹œê°„ ì´ˆê³¼ ì‹œ ì¬ê³  ì˜ˆì•½ì´ ìë™ í•´ì œë©ë‹ˆë‹¤.
      operationId: createOrder
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrderRequest'
            example:
              items:
                - variantId: "var_456"
                  quantity: 2
              shippingAddress:
                name: "í™ê¸¸ë™"
                phone: "010-1234-5678"
                address: "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123"
                addressDetail: "456í˜¸"
                zipCode: "06000"
              shippingMethod: "standard"
              couponCode: "SUMMER2024"
              pointsToUse: 5000
              agreeToTerms: true
              requestMessage: "ë¶€ì¬ ì‹œ ê²½ë¹„ì‹¤ì— ë§¡ê²¨ì£¼ì„¸ìš”"
      responses:
        '201':
          description: ì£¼ë¬¸ ìƒì„± ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
              example:
                id: "ord_789"
                orderNumber: "2024031500123"
                status: "PENDING_PAYMENT"
                reservationExpiry: "2024-03-15T10:45:00Z"
                items:
                  - id: "item_1"
                    product:
                      id: "prod_123"
                      name: "ìŠ¬ë¦¼í• ì²­ë°”ì§€"
                    variant:
                      sku: "LEVI-501-BLK-32-REG"
                    quantity: 2
                    price: 79000
                    subtotal: 158000
                payment:
                  amount: 156000
                  breakdown:
                    subtotal: 158000
                    discount: -10000
                    pointsUsed: -5000
                    shipping: 3000
                    total: 146000
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '409':
          description: ì¬ê³  ë¶€ì¡±
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "INSUFFICIENT_STOCK"
                message: "ì¼ë¶€ ìƒí’ˆì˜ ì¬ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤."

  /orders/{orderId}:
    get:
      tags:
        - Orders
      summary: ì£¼ë¬¸ ìƒì„¸ ì¡°íšŒ
      description: íŠ¹ì • ì£¼ë¬¸ì˜ ìƒì„¸ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: getOrder
      security:
        - bearerAuth: []
      parameters:
        - name: orderId
          in: path
          required: true
          schema:
            type: string
          example: "ord_789"
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderDetail'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  /orders/{orderId}/cancel:
    post:
      tags:
        - Orders
      summary: ì£¼ë¬¸ ì·¨ì†Œ
      description: |
        ì£¼ë¬¸ì„ ì·¨ì†Œí•©ë‹ˆë‹¤.
        
        **ì·¨ì†Œ ê°€ëŠ¥ ì¡°ê±´:**
        - ê²°ì œ ëŒ€ê¸°: ì¦‰ì‹œ ì·¨ì†Œ
        - ê²°ì œ ì™„ë£Œ: í™˜ë¶ˆ ì²˜ë¦¬
        - ë°°ì†¡ ì¤€ë¹„ì¤‘: ê°€ëŠ¥
        - ë°°ì†¡ì¤‘/ë°°ì†¡ì™„ë£Œ: ë¶ˆê°€ (ë°˜í’ˆ í•„ìš”)
      operationId: cancelOrder
      security:
        - bearerAuth: []
      parameters:
        - name: orderId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - reason
              properties:
                reason:
                  type: string
                  enum:
                    - CHANGE_OF_MIND
                    - FOUND_BETTER_PRICE
                    - ACCIDENTAL_ORDER
                    - OTHER
                  description: ì·¨ì†Œ ì‚¬ìœ 
                detailReason:
                  type: string
                  maxLength: 500
                  description: ìƒì„¸ ì‚¬ìœ 
            example:
              reason: "CHANGE_OF_MIND"
              detailReason: "ì‚¬ì´ì¦ˆê°€ ë§ì§€ ì•Šì„ ê²ƒ ê°™ì•„ìš”"
      responses:
        '200':
          description: ì·¨ì†Œ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  refundAmount:
                    type: integer
                  refundMethod:
                    type: string
                  estimatedRefundDate:
                    type: string
                    format: date
              example:
                message: "ì£¼ë¬¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤."
                refundAmount: 146000
                refundMethod: "CARD"
                estimatedRefundDate: "2024-03-20"
        '400':
          description: ì·¨ì†Œ ë¶ˆê°€
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "CANNOT_CANCEL"
                message: "ì´ë¯¸ ë°°ì†¡ì´ ì‹œì‘ë˜ì–´ ì·¨ì†Œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë°˜í’ˆì„ ì‹ ì²­í•´ì£¼ì„¸ìš”."
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  # ============================================
  # Payments API
  # ============================================
  /payments:
    post:
      tags:
        - Payments
      summary: ê²°ì œ ìš”ì²­
      description: |
        ì£¼ë¬¸ì— ëŒ€í•œ ê²°ì œë¥¼ ìš”ì²­í•©ë‹ˆë‹¤.

        **[P0] ë©±ë“±ì„± í‚¤ í•„ìˆ˜:**
        - ìš”ì²­ í—¤ë”ì— `Idempotency-Key` í¬í•¨ í•„ìˆ˜
        - UUID í˜•ì‹ (ì˜ˆ: `550e8400-e29b-41d4-a716-446655440000`)
        - ë™ì¼í•œ ê²°ì œëŠ” í•­ìƒ ê°™ì€ í‚¤ ì‚¬ìš©
        - ì¤‘ë³µ ìš”ì²­ ì‹œ ê¸°ì¡´ ê²°ê³¼ ë°˜í™˜ (200 OK)

        **ì£¼ì˜ì‚¬í•­:**
        - ì¹´ë“œ ì •ë³´ëŠ” PGì‚¬ í† í°ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
        - ì¹´ë“œë²ˆí˜¸ë¥¼ ì§ì ‘ ì „ì†¡í•˜ì§€ ë§ˆì„¸ìš”.
        - ê²°ì œ ìŠ¹ì¸ ì‹œ ì¬ê³ ê°€ ì‹¤ì œë¡œ ì°¨ê°ë©ë‹ˆë‹¤.

        **ê²°ì œ ì‹¤íŒ¨ ì‹œ:**
        - ì¬ê³  ì˜ˆì•½ì´ ìœ ì§€ë©ë‹ˆë‹¤.
        - ìµœëŒ€ 3íšŒê¹Œì§€ ì¬ì‹œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.
        - ìƒˆë¡œìš´ `Idempotency-Key` ì‚¬ìš© ì‹œ ì¬ì‹œë„ë¡œ ì²˜ë¦¬ë¨
      operationId: createPayment
      security:
        - bearerAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: true
          schema:
            type: string
            format: uuid
          description: '[P0] ë©±ë“±ì„± í‚¤ (ì¤‘ë³µ ê²°ì œ ë°©ì§€)'
          example: "550e8400-e29b-41d4-a716-446655440000"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePaymentRequest'
            example:
              orderId: "ord_789"
              method: "CARD"
              amount: 146000
              cardInfo:
                pgToken: "tok_abc123def456"
      responses:
        '201':
          description: ê²°ì œ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Payment'
              example:
                id: "pay_999"
                orderId: "ord_789"
                status: "APPROVED"
                method: "CARD"
                amount: 146000
                transactionId: "pg_txn_123456"
                approvedAt: "2024-03-15T10:35:00Z"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '402':
          description: ê²°ì œ ì‹¤íŒ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "PAYMENT_FAILED"
                message: "ì¹´ë“œ í•œë„ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤."
                details:
                  pgCode: "INSUFFICIENT_FUNDS"
                  retryable: true

  /payments/{paymentId}:
    get:
      tags:
        - Payments
      summary: ê²°ì œ ìƒíƒœ ì¡°íšŒ
      description: ê²°ì œ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: getPayment
      security:
        - bearerAuth: []
      parameters:
        - name: paymentId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Payment'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  /payments/{paymentId}/refund:
    post:
      tags:
        - Payments
      summary: ê²°ì œ ì·¨ì†Œ/í™˜ë¶ˆ
      description: |
        ê²°ì œë¥¼ ì·¨ì†Œí•˜ê±°ë‚˜ í™˜ë¶ˆí•©ë‹ˆë‹¤.
        
        **í™˜ë¶ˆ ë°©ë²•:**
        - ì¹´ë“œ ê²°ì œ: ìŠ¹ì¸ ì·¨ì†Œ (3~7ì¼ ì†Œìš”)
        - ê³„ì¢Œì´ì²´: í™˜ë¶ˆ ê³„ì¢Œë¡œ ì…ê¸ˆ (ì˜ì—…ì¼ ê¸°ì¤€ 3ì¼)
      operationId: refundPayment
      security:
        - bearerAuth: []
      parameters:
        - name: paymentId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - amount
                - reason
              properties:
                amount:
                  type: integer
                  description: í™˜ë¶ˆ ê¸ˆì•¡ (ë¶€ë¶„ í™˜ë¶ˆ ê°€ëŠ¥)
                reason:
                  type: string
                  enum:
                    - ORDER_CANCELLED
                    - RETURN_APPROVED
                    - DEFECTIVE_PRODUCT
                  description: í™˜ë¶ˆ ì‚¬ìœ 
            example:
              amount: 146000
              reason: "ORDER_CANCELLED"
      responses:
        '200':
          description: í™˜ë¶ˆ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  refundId:
                    type: string
                  amount:
                    type: integer
                  status:
                    type: string
                    enum:
                      - PENDING
                      - COMPLETED
                  estimatedDate:
                    type: string
                    format: date
              example:
                refundId: "ref_111"
                amount: 146000
                status: "PENDING"
                estimatedDate: "2024-03-20"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  # ============================================
  # Coupons API
  # ============================================
  /users/me/coupons:
    get:
      tags:
        - Coupons
      summary: ë‚´ ì¿ í° ëª©ë¡
      description: ì‚¬ìš© ê°€ëŠ¥í•œ ì¿ í° ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: getMyCoupons
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum:
              - AVAILABLE
              - USED
              - EXPIRED
          description: ì¿ í° ìƒíƒœ
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Coupon'
              example:
                - id: "coupon_1"
                  code: "SUMMER2024"
                  name: "ì—¬ë¦„ ì‹œì¦Œ 10,000ì› í• ì¸"
                  type: "FIXED_AMOUNT"
                  discount: 10000
                  minOrderAmount: 50000
                  status: "AVAILABLE"
                  expiresAt: "2024-12-31T23:59:59Z"
        '401':
          $ref: '#/components/responses/Unauthorized'

  /coupons/validate:
    post:
      tags:
        - Coupons
      summary: ì¿ í° ì ìš© ê°€ëŠ¥ ì—¬ë¶€ ê²€ì¦
      description: íŠ¹ì • ì£¼ë¬¸ì— ì¿ í°ì„ ì ìš©í•  ìˆ˜ ìˆëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.
      operationId: validateCoupon
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - couponCode
                - orderAmount
              properties:
                couponCode:
                  type: string
                orderAmount:
                  type: integer
                items:
                  type: array
                  items:
                    type: object
                    properties:
                      productId:
                        type: string
                      variantId:
                        type: string
                      quantity:
                        type: integer
            example:
              couponCode: "SUMMER2024"
              orderAmount: 158000
              items:
                - productId: "prod_123"
                  variantId: "var_456"
                  quantity: 2
      responses:
        '200':
          description: ê²€ì¦ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  valid:
                    type: boolean
                  discount:
                    type: integer
                  message:
                    type: string
              example:
                valid: true
                discount: 10000
                message: "10,000ì› í• ì¸ì´ ì ìš©ë©ë‹ˆë‹¤"
        '400':
          description: ê²€ì¦ ì‹¤íŒ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "INVALID_COUPON"
                message: "ìµœì†Œ ì£¼ë¬¸ ê¸ˆì•¡(50,000ì›)ì„ ì¶©ì¡±í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."

  # ============================================
  # Points API
  # ============================================
  /users/me/points/balance:
    get:
      tags:
        - Points
      summary: í¬ì¸íŠ¸ ì”ì•¡ ì¡°íšŒ
      description: |
        ì‚¬ìš© ê°€ëŠ¥í•œ í¬ì¸íŠ¸ ì”ì•¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

        **[P0] í¬ì¸íŠ¸ ì‹œìŠ¤í…œ ê·œì¹™:**

        1ï¸âƒ£ **í¬ì¸íŠ¸ ì ë¦½ (EARNED)**
           - êµ¬ë§¤ í™•ì • (ë°°ì†¡ ì™„ë£Œ í›„): ê²°ì œì•¡ì˜ **1%**
           - ë¦¬ë·° ì‘ì„±: **500P** (ì¼ë°˜ ë¦¬ë·°)
           - í¬í†  ë¦¬ë·°: **1,000P** (ì‚¬ì§„ 5ì¥ ì´ìƒ)
           - ì¶”ì²œ ì´ë²¤íŠ¸: **1,000P~5,000P** (ì •ê¸° í”„ë¡œëª¨ì…˜)

        2ï¸âƒ£ **í¬ì¸íŠ¸ ì‚¬ìš© (USED)**
           - ê²°ì œ ì‹œì : ì£¼ë¬¸ ìƒì„± â†’ ê²°ì œ ìŠ¹ì¸ ì „ ì ìš©
           - ìµœì†Œ ë‹¨ìœ„: **100P ë‹¨ìœ„**ë¡œë§Œ ì‚¬ìš© ê°€ëŠ¥
           - ìµœëŒ€ ì œí•œ: ì£¼ë¬¸ê¸ˆì•¡ì˜ **50% ì´ìƒ í¬ì¸íŠ¸ ì‚¬ìš© ë¶ˆê°€**
           - í¬ì¸íŠ¸ ì‚¬ìš© ì‹¤íŒ¨ ì‹œ: ìë™ í™˜ë¶ˆ (Saga Pattern)

        3ï¸âƒ£ **í¬ì¸íŠ¸ ì†Œë©¸ (EXPIRED)**
           - ì ë¦½ì¼ë¡œë¶€í„° **12ê°œì›” ê²½ê³¼** ì‹œ ìë™ ì†Œë©¸
           - ì†Œë©¸ 7ì¼ ì „: ì‚¬ìš©ì ì•Œë¦¼ (ì´ë©”ì¼ + í‘¸ì‹œ)
           - ë¯¸ì‚¬ìš© í¬ì¸íŠ¸ í™•ì¸: `expiringPoints` í•„ë“œ ì°¸ì¡°

        4ï¸âƒ£ **í¬ì¸íŠ¸ ë³µêµ¬ (RECOVERY)**
           - ë°˜í’ˆ ì™„ë£Œ ì‹œ: ë°˜í’ˆ ëŒ€ìƒ ìƒí’ˆ êµ¬ë§¤ ì‹œ ì ë¦½ëœ í¬ì¸íŠ¸ ë°˜í™˜
           - ë¶€ë¶„ ë°˜í’ˆ: í•´ë‹¹ ìƒí’ˆë§Œ ë¹„ë¡€ê³„ì‚° ë³µêµ¬
           - ì˜ˆì‹œ: 10,000ì› ìƒí’ˆ í™˜ë¶ˆ â†’ ì ë¦½ëœ 100P í™˜ë¶ˆ

        **ì”ì•¡ ì¡°íšŒ ì˜ˆì‹œ:**
        - ì´ ë³´ìœ : 25,000P
        - ì‚¬ìš© ê°€ëŠ¥: 22,000P (30ì¼ ì´ë‚´ ì†Œë©¸ 3,000P ì œì™¸)
        - ê³§ ì†Œë©¸: 3,000P (2024-12-31 ì†Œë©¸ ì˜ˆì •)
      operationId: getPointBalance
      security:
        - bearerAuth: []
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  balance:
                    type: integer
                  expiringPoints:
                    type: integer
                    description: ê³§ ì†Œë©¸ë  í¬ì¸íŠ¸ (30ì¼ ì´ë‚´)
                  expiryDate:
                    type: string
                    format: date
              example:
                balance: 15000
                expiringPoints: 3000
                expiryDate: "2024-12-31"
        '401':
          $ref: '#/components/responses/Unauthorized'

  /users/me/points/history:
    get:
      tags:
        - Points
      summary: í¬ì¸íŠ¸ íˆìŠ¤í† ë¦¬
      description: í¬ì¸íŠ¸ ì ë¦½/ì‚¬ìš© ë‚´ì—­ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: getPointHistory
      security:
        - bearerAuth: []
      parameters:
        - name: type
          in: query
          schema:
            type: string
            enum:
              - EARNED
              - USED
              - EXPIRED
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/PointHistory'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '401':
          $ref: '#/components/responses/Unauthorized'

  # ============================================
  # Inventory API
  # ============================================
  /inventory/skus/{sku}:
    get:
      tags:
        - Inventory
      summary: ì‹¤ì‹œê°„ ì¬ê³  ì¡°íšŒ
      description: SKUì˜ ì‹¤ì‹œê°„ ì¬ê³  ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: getInventory
      parameters:
        - name: sku
          in: path
          required: true
          schema:
            type: string
          example: "LEVI-501-BLK-32-REG"
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Inventory'
              example:
                sku: "LEVI-501-BLK-32-REG"
                available: 15
                reserved: 3
                physical: 20
                safetyStock: 2
                status: "IN_STOCK"
        '404':
          $ref: '#/components/responses/NotFound'

  /inventory/restock-notifications:
    post:
      tags:
        - Inventory
      summary: ì¬ì…ê³  ì•Œë¦¼ ì‹ ì²­
      description: í’ˆì ˆ ìƒí’ˆì˜ ì¬ì…ê³  ì•Œë¦¼ì„ ì‹ ì²­í•©ë‹ˆë‹¤.
      operationId: subscribeRestockNotification
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sku
              properties:
                sku:
                  type: string
                notifyVia:
                  type: array
                  items:
                    type: string
                    enum:
                      - EMAIL
                      - PUSH
                      - SMS
            example:
              sku: "LEVI-501-BLK-32-REG"
              notifyVia: ["EMAIL", "PUSH"]
      responses:
        '201':
          description: ì‹ ì²­ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              example:
                message: "ì¬ì…ê³  ì•Œë¦¼ì´ ì‹ ì²­ë˜ì—ˆìŠµë‹ˆë‹¤."
        '401':
          $ref: '#/components/responses/Unauthorized'

  # ============================================
  # Shipments API
  # ============================================
  /shipments/{shipmentId}/tracking:
    get:
      tags:
        - Shipments
      summary: ë°°ì†¡ ì¶”ì 
      description: ë°°ì†¡ ìƒíƒœë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¶”ì í•©ë‹ˆë‹¤.
      operationId: trackShipment
      parameters:
        - name: shipmentId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShipmentTracking'
        '404':
          $ref: '#/components/responses/NotFound'

  # ============================================
  # Returns API
  # ============================================
  /returns:
    post:
      tags:
        - Returns
      summary: ë°˜í’ˆ ìš”ì²­
      description: |
        ìƒí’ˆ ë°˜í’ˆì„ ìš”ì²­í•©ë‹ˆë‹¤.
        
        **ë°˜í’ˆ ê°€ëŠ¥ ê¸°ê°„:** ë°°ì†¡ ì™„ë£Œ í›„ 7ì¼ ì´ë‚´
        
        **ë°˜í’ˆ ë°°ì†¡ë¹„:**
        - ë‹¨ìˆœ ë³€ì‹¬: ê³ ê° ë¶€ë‹´ (6,000ì›)
        - ë¶ˆëŸ‰/ì˜¤ë°°ì†¡: íŒë§¤ì ë¶€ë‹´ (ë¬´ë£Œ)
      operationId: createReturn
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateReturnRequest'
      responses:
        '201':
          description: ë°˜í’ˆ ìš”ì²­ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Return'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /returns/{returnId}:
    get:
      tags:
        - Returns
      summary: ë°˜í’ˆ ìƒíƒœ ì¡°íšŒ
      operationId: getReturn
      security:
        - bearerAuth: []
      parameters:
        - name: returnId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReturnDetail'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  # ============================================
  # Exchanges API
  # ============================================
  /exchanges:
    post:
      tags:
        - Exchanges
      summary: êµí™˜ ìš”ì²­
      description: ìƒí’ˆ êµí™˜ì„ ìš”ì²­í•©ë‹ˆë‹¤ (ë‹¤ë¥¸ ì‚¬ì´ì¦ˆ/ìƒ‰ìƒìœ¼ë¡œ ë³€ê²½).
      operationId: createExchange
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateExchangeRequest'
      responses:
        '201':
          description: êµí™˜ ìš”ì²­ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Exchange'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /exchanges/{exchangeId}:
    get:
      tags:
        - Exchanges
      summary: êµí™˜ ìƒíƒœ ì¡°íšŒ
      operationId: getExchange
      security:
        - bearerAuth: []
      parameters:
        - name: exchangeId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExchangeDetail'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  # ============================================
  # Reviews API
  # ============================================
  /products/{productId}/reviews:
    get:
      tags:
        - Reviews
      summary: ìƒí’ˆ ë¦¬ë·° ëª©ë¡
      description: íŠ¹ì • ìƒí’ˆì˜ ë¦¬ë·°ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      operationId: listProductReviews
      parameters:
        - name: productId
          in: path
          required: true
          schema:
            type: string
        - name: rating
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 5
          description: í‰ì  í•„í„°
        - name: hasPhoto
          in: query
          schema:
            type: boolean
          description: í¬í†  ë¦¬ë·°ë§Œ ë³´ê¸°
        - name: sort
          in: query
          schema:
            type: string
            enum:
              - recent
              - helpful
            default: recent
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Review'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
                  summary:
                    type: object
                    properties:
                      averageRating:
                        type: number
                      totalReviews:
                        type: integer
                      ratingDistribution:
                        type: object
                        properties:
                          5:
                            type: integer
                          4:
                            type: integer
                          3:
                            type: integer
                          2:
                            type: integer
                          1:
                            type: integer

  /reviews:
    post:
      tags:
        - Reviews
      summary: ë¦¬ë·° ì‘ì„±
      description: |
        êµ¬ë§¤ í™•ì • í›„ ë¦¬ë·°ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        
        **í¬ì¸íŠ¸ ì ë¦½:**
        - ì¼ë°˜ ë¦¬ë·°: 500P
        - í¬í†  ë¦¬ë·°: 1,000P
      operationId: createReview
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateReviewRequest'
      responses:
        '201':
          description: ë¦¬ë·° ì‘ì„± ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Review'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /reviews/{reviewId}:
    patch:
      tags:
        - Reviews
      summary: ë¦¬ë·° ìˆ˜ì •
      operationId: updateReview
      security:
        - bearerAuth: []
      parameters:
        - name: reviewId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                rating:
                  type: integer
                  minimum: 1
                  maximum: 5
                title:
                  type: string
                content:
                  type: string
      responses:
        '200':
          description: ìˆ˜ì • ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Review'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

    delete:
      tags:
        - Reviews
      summary: ë¦¬ë·° ì‚­ì œ
      operationId: deleteReview
      security:
        - bearerAuth: []
      parameters:
        - name: reviewId
          in: path
          required: true
          schema:
            type: string
      responses:
        '204':
          description: ì‚­ì œ ì„±ê³µ
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  /reviews/{reviewId}/helpful:
    post:
      tags:
        - Reviews
      summary: ë¦¬ë·° ë„ì›€ë¨ í‘œì‹œ
      operationId: markReviewHelpful
      security:
        - bearerAuth: []
      parameters:
        - name: reviewId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  helpfulCount:
                    type: integer
        '401':
          $ref: '#/components/responses/Unauthorized'

  # ============================================
  # Webhooks API
  # ============================================
  /webhooks/payment:
    post:
      tags:
        - Webhooks
      summary: ê²°ì œ Webhook ìˆ˜ì‹  (PGì‚¬ â†’ ìš°ë¦¬ ì„œë²„)
      description: |
        PGì‚¬ì—ì„œ ê²°ì œ ê²°ê³¼ë¥¼ ì „ì†¡í•˜ëŠ” Webhookì…ë‹ˆë‹¤.

        **[P0] Webhook ë³´ì•ˆ (ë°˜ë“œì‹œ êµ¬í˜„):**

        1ï¸âƒ£ **HMAC-SHA256 ì„œëª… ê²€ì¦**
           - í—¤ë”: `X-Signature: {HMAC-SHA256-HEX}`
           - ì„œëª… ëŒ€ìƒ: ìš”ì²­ ë°”ë”” (ë¬¸ìì—´í™”ëœ JSON)
           - ë¹„ë°€í‚¤: í™˜ê²½ë³€ìˆ˜ `WEBHOOK_SECRET_KEY`
           - ê²€ì¦ ì‹¤íŒ¨ ì‹œ: **401 Unauthorized** ë°˜í™˜
           ```
           signature = HMAC-SHA256(body, secret_key)
           if signature != X-Signature header: return 401
           ```

        2ï¸âƒ£ **Nonce + Timestamp ê²€ì¦**
           - í—¤ë”: `X-Nonce: {UUID}` (PGì‚¬ ì´ë²¤íŠ¸ ê³ ìœ  ID)
           - í—¤ë”: `X-Timestamp: {Unix-timestamp}` (ë°€ë¦¬ì´ˆ ë‹¨ìœ„)
           - íƒ€ì„ìŠ¤íƒ¬í”„ ê²€ì¦: í˜„ì¬ ì‹œê°„ Â±5ë¶„ ë²”ìœ„
           - ì‹œê°„ ì´ˆê³¼: **400 Bad Request** ë°˜í™˜
           ```
           if |currentTime - X-Timestamp| > 5 minutes: return 400
           ```

        3ï¸âƒ£ **Event ID ê¸°ë°˜ ë©±ë“±ì„± (Idempotency)**
           - DBì— ìˆ˜ì‹ í•œ `X-Nonce` ì €ì¥
           - ì¤‘ë³µ ìš”ì²­ ê°ì§€: SELECT WHERE nonce = X-Nonce
           - ì¤‘ë³µì´ë©´: ê¸°ì¡´ ê²°ê³¼ ë°˜í™˜ (200 OK + ì´ì „ ì‘ë‹µ)
           - ì¤‘ë³µ ì•„ë‹ˆë©´: ìƒˆë¡œ ì²˜ë¦¬
           ```
           if exists(webhooks.nonce = X-Nonce):
               return savedResponse[nonce]
           else:
               process payment â†’ save response â†’ return 200
           ```

        **êµ¬í˜„ ì˜ˆì‹œ:**
        ```
        POST /webhooks/payment
        Content-Type: application/json
        X-Signature: a1b2c3d4...
        X-Nonce: 550e8400-e29b-41d4-a716-446655440000
        X-Timestamp: 1710489300000

        {
          "paymentId": "pg_txn_123456",
          "orderId": "ord_789",
          "status": "completed",
          "amount": 146000
        }
        ```

        **ì‘ë‹µ:**
        - ì„±ê³µ (200): `{"status": "received", "nonce": "550e8400..."}`
        - ì¤‘ë³µ (200): ì´ì „ ì‘ë‹µê³¼ ë™ì¼í•˜ê²Œ ë°˜í™˜
        - ê²€ì¦ ì‹¤íŒ¨ (401/400): ì—ëŸ¬ ë©”ì‹œì§€

        **ì£¼ì˜ì‚¬í•­:**
        - 3íšŒ ì´ìƒ ì‹¤íŒ¨ ì‹œ: ì¬ì‹œë„ ì•ˆ í•¨ (PGì‚¬ ì •ì±…)
        - íƒ€ì„ì•„ì›ƒ ì„¤ì •: 5ì´ˆ ì´ë‚´ ì‘ë‹µ í•„ìˆ˜
        - ì‘ë‹µ ë³¸ë¬¸: ê°„ê²°í•˜ê²Œ (PGì‚¬ëŠ” ë³¸ë¬¸ ì½ì§€ ì•ŠìŒ)
      operationId: receivePaymentWebhook
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - paymentId
                - orderId
                - status
                - amount
              properties:
                paymentId:
                  type: string
                  description: PGì‚¬ ê²°ì œ ID
                orderId:
                  type: string
                  description: ìš°ë¦¬ ì„œë²„ì˜ ì£¼ë¬¸ ID
                status:
                  type: string
                  enum:
                    - completed
                    - failed
                    - cancelled
                  description: ê²°ì œ ìƒíƒœ
                amount:
                  type: integer
                  description: ê²°ì œ ê¸ˆì•¡ (ì›)
                transactionId:
                  type: string
                  description: PGì‚¬ ê±°ë˜ ID
                failReason:
                  type: string
                  description: ì‹¤íŒ¨ ì‚¬ìœ  (status=failedì¸ ê²½ìš°ë§Œ)
            example:
              paymentId: "pg_txn_123456"
              orderId: "ord_789"
              status: "completed"
              amount: 146000
              transactionId: "txn_abc123"
      responses:
        '200':
          description: ì›¹í›… ìˆ˜ì‹  ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "received"
                  nonce:
                    type: string
                    description: ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•œ Event ID
        '400':
          description: íƒ€ì„ìŠ¤íƒí”„ ê²€ì¦ ì‹¤íŒ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "INVALID_TIMESTAMP"
                message: "ìš”ì²­ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. (Â±5ë¶„ ë²”ìœ„)"
        '401':
          description: ì„œëª… ê²€ì¦ ì‹¤íŒ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "INVALID_SIGNATURE"
                message: "HMAC-SHA256 ì„œëª… ê²€ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."

  # ============================================
  # Users API
  # ============================================
  /users/register:
    post:
      tags:
        - Users
      summary: íšŒì›ê°€ì…
      operationId: registerUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '201':
          description: ê°€ì… ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '409':
          description: ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /users/login:
    post:
      tags:
        - Users
      summary: ë¡œê·¸ì¸
      operationId: loginUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  format: password
            example:
              email: "user@example.com"
              password: "********"
      responses:
        '200':
          description: ë¡œê·¸ì¸ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /users/me:
    get:
      tags:
        - Users
      summary: ë‚´ ì •ë³´ ì¡°íšŒ
      operationId: getCurrentUser
      security:
        - bearerAuth: []
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '401':
          $ref: '#/components/responses/Unauthorized'

    patch:
      tags:
        - Users
      summary: ë‚´ ì •ë³´ ìˆ˜ì •
      operationId: updateCurrentUser
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                phone:
                  type: string
                  pattern: '^\d{3}-\d{4}-\d{4}$'
      responses:
        '200':
          description: ìˆ˜ì • ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /users/me/addresses:
    get:
      tags:
        - Users
      summary: ë°°ì†¡ì§€ ëª©ë¡ ì¡°íšŒ
      operationId: listAddresses
      security:
        - bearerAuth: []
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Address'
        '401':
          $ref: '#/components/responses/Unauthorized'

    post:
      tags:
        - Users
      summary: ë°°ì†¡ì§€ ì¶”ê°€
      operationId: createAddress
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Address'
      responses:
        '201':
          description: ì¶”ê°€ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Address'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /users/me/size-profile:
    get:
      tags:
        - Users
      summary: ì‚¬ì´ì¦ˆ í”„ë¡œí•„ ì¡°íšŒ
      operationId: getSizeProfile
      security:
        - bearerAuth: []
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SizeProfile'
        '401':
          $ref: '#/components/responses/Unauthorized'

    patch:
      tags:
        - Users
      summary: ì‚¬ì´ì¦ˆ í”„ë¡œí•„ ìˆ˜ì •
      operationId: updateSizeProfile
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SizeProfile'
      responses:
        '200':
          description: ìˆ˜ì • ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SizeProfile'
        '401':
          $ref: '#/components/responses/Unauthorized'

# ============================================
# Components
# ============================================
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        JWT Bearer Tokenì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
        
        **í—¤ë” ì˜ˆì‹œ:**
        Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

  parameters:
    # ê³µí†µ í•„í„° íŒŒë¼ë¯¸í„°
    CategoryFilter:
      name: category
      in: query
      schema:
        type: string
        enum:
          - tops
          - bottoms
          - outerwear
          - dresses
          - shoes
          - accessories
      description: ì¹´í…Œê³ ë¦¬ í•„í„°

    BrandFilter:
      name: brand
      in: query
      schema:
        type: string
      description: ë¸Œëœë“œ í•„í„°
      example: "LEVI'S"

    ColorFilter:
      name: color
      in: query
      schema:
        type: array
        items:
          type: string
      style: form
      explode: true
      description: ìƒ‰ìƒ í•„í„° (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)
      example: ["black", "navy"]

    SizeFilter:
      name: size
      in: query
      schema:
        type: array
        items:
          type: string
      style: form
      explode: true
      description: ì‚¬ì´ì¦ˆ í•„í„° (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)
      example: ["S", "M", "L"]

    MinPrice:
      name: minPrice
      in: query
      schema:
        type: integer
        minimum: 0
      description: ìµœì†Œ ê°€ê²©
      example: 50000

    MaxPrice:
      name: maxPrice
      in: query
      schema:
        type: integer
        minimum: 0
      description: ìµœëŒ€ ê°€ê²©
      example: 100000

    InStock:
      name: inStock
      in: query
      schema:
        type: boolean
        default: false
      description: ì¬ê³  ìˆëŠ” ìƒí’ˆë§Œ ì¡°íšŒ

    Sort:
      name: sort
      in: query
      schema:
        type: string
        enum:
          - price
          - -price
          - createdAt
          - -createdAt
          - popularity
        default: -createdAt
      description: |
        ì •ë ¬ ê¸°ì¤€
        - `price`: ê°€ê²© ë‚®ì€ìˆœ
        - `-price`: ê°€ê²© ë†’ì€ìˆœ
        - `createdAt`: ì˜¤ë˜ëœìˆœ
        - `-createdAt`: ìµœì‹ ìˆœ (ê¸°ë³¸ê°’)
        - `popularity`: ì¸ê¸°ìˆœ

    Page:
      name: page
      in: query
      schema:
        type: integer
        minimum: 1
        default: 1
      description: í˜ì´ì§€ ë²ˆí˜¸

    Limit:
      name: limit
      in: query
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20
      description: í˜ì´ì§€ë‹¹ í•­ëª© ìˆ˜

  schemas:
    # ============================================
    # Common Schemas
    # ============================================
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: ì—ëŸ¬ ì½”ë“œ
          example: "VALIDATION_ERROR"
        message:
          type: string
          description: ì—ëŸ¬ ë©”ì‹œì§€
          example: "ìš”ì²­ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."
        details:
          type: object
          description: ì¶”ê°€ ì—ëŸ¬ ì •ë³´
          additionalProperties: true
          example:
            field: "email"
            issue: "ì´ë¯¸ ì‚¬ìš©ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤."

    Pagination:
      type: object
      properties:
        page:
          type: integer
          description: í˜„ì¬ í˜ì´ì§€
          example: 1
        limit:
          type: integer
          description: í˜ì´ì§€ë‹¹ í•­ëª© ìˆ˜
          example: 20
        total:
          type: integer
          description: ì „ì²´ í•­ëª© ìˆ˜
          example: 150
        totalPages:
          type: integer
          description: ì „ì²´ í˜ì´ì§€ ìˆ˜
          example: 8

    # ============================================
    # Product Schemas
    # ============================================
    Product:
      type: object
      properties:
        id:
          type: string
          example: "prod_123"
        name:
          type: string
          example: "ìŠ¬ë¦¼í• ì²­ë°”ì§€"
        brand:
          type: string
          example: "LEVI'S"
        category:
          type: string
          enum:
            - tops
            - bottoms
            - outerwear
            - dresses
            - shoes
            - accessories
          example: "pants"
        basePrice:
          type: integer
          description: ì •ê°€
          example: 89000
        salePrice:
          type: integer
          description: íŒë§¤ê°€ (í• ì¸ ì ìš©)
          example: 79000
        discountRate:
          type: integer
          description: í• ì¸ìœ¨ (%)
          example: 11
        images:
          type: array
          items:
            type: string
            format: uri
          minItems: 1
          example:
            - "https://cdn.fashionstore.com/prod_123_1.jpg"
            - "https://cdn.fashionstore.com/prod_123_2.jpg"
        variantCount:
          type: integer
          description: ë³€ëŸ‰ ê°œìˆ˜ (ìƒ‰ìƒÃ—ì‚¬ì´ì¦ˆ ì¡°í•©)
          example: 12
        rating:
          type: number
          format: float
          minimum: 0
          maximum: 5
          example: 4.5
        reviewCount:
          type: integer
          example: 128
        tags:
          type: array
          items:
            type: string
          example: ["ë² ìŠ¤íŠ¸", "ì‹ ìƒí’ˆ"]
        createdAt:
          type: string
          format: date-time

    ProductDetail:
      allOf:
        - $ref: '#/components/schemas/Product'
        - type: object
          properties:
            description:
              type: string
              description: ìƒí’ˆ ì„¤ëª…
              example: "í´ë˜ì‹í•œ í•ì˜ ì²­ë°”ì§€ë¡œ ì–´ë–¤ ìŠ¤íƒ€ì¼ì—ë„ ì˜ ì–´ìš¸ë¦½ë‹ˆë‹¤."
            material:
              type: string
              example: "ë©´ 98%, ìŠ¤íŒë±ìŠ¤ 2%"
            careInstructions:
              type: array
              items:
                type: string
              example:
                - "ë‹¨ë… ì„¸íƒ"
                - "ì°¬ë¬¼ ì„¸íƒ"
                - "ê±´ì¡°ê¸° ì‚¬ìš© ê¸ˆì§€"
            variants:
              type: array
              items:
                $ref: '#/components/schemas/ProductVariant'
              description: ëª¨ë“  ë³€ëŸ‰ (SKU)
            sizeGuide:
              $ref: '#/components/schemas/SizeGuide'
            relatedProducts:
              type: array
              items:
                $ref: '#/components/schemas/Product'
              description: ì—°ê´€ ìƒí’ˆ ì¶”ì²œ

    ProductVariant:
      type: object
      properties:
        id:
          type: string
          example: "var_456"
        sku:
          type: string
          description: SKU ì½”ë“œ
          example: "LEVI-501-BLK-32-REG"
        color:
          type: string
          example: "black"
        colorHex:
          type: string
          description: ìƒ‰ìƒ HEX ì½”ë“œ
          example: "#000000"
        size:
          type: string
          example: "32"
        length:
          type: string
          enum:
            - regular
            - short
            - long
          example: "regular"
        price:
          type: integer
          description: íŒë§¤ ê°€ê²©
          example: 79000
        originalPrice:
          type: integer
          description: ì›ê°€
          example: 89000
        stock:
          type: integer
          description: ê°€ìš© ì¬ê³ 
          example: 15
        stockStatus:
          type: string
          enum:
            - IN_STOCK
            - LOW_STOCK
            - OUT_OF_STOCK
          example: "IN_STOCK"
        images:
          type: array
          items:
            type: string
            format: uri
          description: ë³€ëŸ‰ë³„ ì´ë¯¸ì§€

    SizeGuide:
      type: object
      properties:
        brand:
          type: string
          example: "LEVI'S"
        category:
          type: string
          example: "pants"
        measurements:
          type: array
          items:
            type: object
            properties:
              size:
                type: string
                example: "32"
              waist:
                type: number
                description: í—ˆë¦¬ë‘˜ë ˆ (cm)
                example: 82
              hip:
                type: number
                description: ì—‰ë©ì´ë‘˜ë ˆ (cm)
                example: 98
              length:
                type: number
                description: ê¸¸ì´ (cm)
                example: 108

    # ============================================
    # Cart Schemas
    # ============================================
    Cart:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/CartItem'
        summary:
          type: object
          properties:
            itemCount:
              type: integer
              description: ìƒí’ˆ ì¢…ë¥˜ ìˆ˜
              example: 3
            subtotal:
              type: integer
              description: ìƒí’ˆ ê¸ˆì•¡ í•©ê³„
              example: 267000
            estimatedShipping:
              type: integer
              description: ì˜ˆìƒ ë°°ì†¡ë¹„
              example: 3000
            estimatedTotal:
              type: integer
              description: ì˜ˆìƒ ì´ì•¡
              example: 270000

    CartItem:
      type: object
      properties:
        id:
          type: string
          example: "cart_item_1"
        product:
          $ref: '#/components/schemas/Product'
        variant:
          $ref: '#/components/schemas/ProductVariant'
        quantity:
          type: integer
          minimum: 1
          example: 2
        price:
          type: integer
          description: ê°œë‹¹ ê°€ê²©
          example: 79000
        subtotal:
          type: integer
          description: ì†Œê³„
          example: 158000
        addedAt:
          type: string
          format: date-time

    # ============================================
    # Order Schemas
    # ============================================
    OrderStatus:
      type: string
      enum:
        - PENDING_PAYMENT     # ê²°ì œ ëŒ€ê¸°
        - PAID                # ê²°ì œ ì™„ë£Œ
        - PREPARING           # ìƒí’ˆ ì¤€ë¹„ì¤‘
        - SHIPPED             # ë°°ì†¡ ì‹œì‘
        - DELIVERED           # ë°°ì†¡ ì™„ë£Œ
        - CANCELLED           # ì·¨ì†Œ
        - RETURN_REQUESTED    # ë°˜í’ˆ ìš”ì²­
        - RETURN_COMPLETED    # ë°˜í’ˆ ì™„ë£Œ
        - EXCHANGE_REQUESTED  # êµí™˜ ìš”ì²­
        - EXCHANGE_COMPLETED  # êµí™˜ ì™„ë£Œ
      description: ì£¼ë¬¸ ìƒíƒœ

    CreateOrderRequest:
      type: object
      required:
        - items
        - shippingAddress
        - agreeToTerms
      properties:
        items:
          type: array
          minItems: 1
          items:
            type: object
            required:
              - variantId
              - quantity
            properties:
              variantId:
                type: string
              quantity:
                type: integer
                minimum: 1
        shippingAddress:
          $ref: '#/components/schemas/Address'
        shippingMethod:
          type: string
          enum:
            - standard
            - express
            - dawn
          default: standard
          description: ë°°ì†¡ ë°©ë²•
        couponCode:
          type: string
          description: ì¿ í° ì½”ë“œ (ì„ íƒ)
        pointsToUse:
          type: integer
          minimum: 0
          description: ì‚¬ìš©í•  í¬ì¸íŠ¸ (ì„ íƒ)
        agreeToTerms:
          type: boolean
          description: êµ¬ë§¤ ì•½ê´€ ë™ì˜ (í•„ìˆ˜)
        requestMessage:
          type: string
          maxLength: 200
          description: ë°°ì†¡ ìš”ì²­ì‚¬í•­ (ì„ íƒ)

    Order:
      type: object
      properties:
        id:
          type: string
          example: "ord_789"
        orderNumber:
          type: string
          description: ì£¼ë¬¸ë²ˆí˜¸
          example: "2024031500123"
        status:
          $ref: '#/components/schemas/OrderStatus'
        items:
          type: array
          items:
            $ref: '#/components/schemas/OrderItem'
        payment:
          $ref: '#/components/schemas/OrderPayment'
        reservationExpiry:
          type: string
          format: date-time
          description: ì¬ê³  ì˜ˆì•½ ë§Œë£Œ ì‹œê°„ (15ë¶„ TTL)
          example: "2024-03-15T10:45:00Z"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    OrderDetail:
      allOf:
        - $ref: '#/components/schemas/Order'
        - type: object
          properties:
            shipping:
              $ref: '#/components/schemas/OrderShipping'
            timeline:
              type: array
              description: ì£¼ë¬¸ ìƒíƒœ ë³€ê²½ ì´ë ¥
              items:
                type: object
                properties:
                  status:
                    $ref: '#/components/schemas/OrderStatus'
                  timestamp:
                    type: string
                    format: date-time
                  note:
                    type: string

    OrderItem:
      type: object
      properties:
        id:
          type: string
        product:
          $ref: '#/components/schemas/Product'
        variant:
          $ref: '#/components/schemas/ProductVariant'
        quantity:
          type: integer
        price:
          type: integer
          description: ì£¼ë¬¸ ë‹¹ì‹œ ê°€ê²© (ìŠ¤ëƒ…ìƒ·)
        subtotal:
          type: integer

    OrderPayment:
      type: object
      properties:
        amount:
          type: integer
          description: ìµœì¢… ê²°ì œ ê¸ˆì•¡
        breakdown:
          type: object
          description: ê¸ˆì•¡ ìƒì„¸
          properties:
            subtotal:
              type: integer
              description: ìƒí’ˆ ê¸ˆì•¡
            discount:
              type: integer
              description: ì¿ í° í• ì¸ (ìŒìˆ˜)
            pointsUsed:
              type: integer
              description: í¬ì¸íŠ¸ ì‚¬ìš© (ìŒìˆ˜)
            shipping:
              type: integer
              description: ë°°ì†¡ë¹„
            total:
              type: integer
              description: ìµœì¢… ê¸ˆì•¡

    OrderShipping:
      type: object
      properties:
        address:
          $ref: '#/components/schemas/Address'
        method:
          type: string
          enum:
            - standard
            - express
            - dawn
        fee:
          type: integer
          description: ë°°ì†¡ë¹„
        trackingNumber:
          type: string
          description: ì†¡ì¥ ë²ˆí˜¸
        carrier:
          type: string
          description: íƒë°°ì‚¬
          example: "CJëŒ€í•œí†µìš´"
        estimatedDelivery:
          type: string
          format: date
          description: ì˜ˆìƒ ë°°ì†¡ì¼

    # ============================================
    # Payment Schemas
    # ============================================
    CreatePaymentRequest:
      type: object
      required:
        - orderId
        - method
        - amount
      properties:
        orderId:
          type: string
        method:
          type: string
          enum:
            - CARD
            - TRANSFER
            - VIRTUAL_ACCOUNT
            - KAKAO_PAY
            - NAVER_PAY
          description: ê²°ì œ ìˆ˜ë‹¨
        amount:
          type: integer
          description: ê²°ì œ ê¸ˆì•¡
        cardInfo:
          type: object
          description: PGì‚¬ í† í° (ì¹´ë“œë²ˆí˜¸ ì§ì ‘ ì „ì†¡ ê¸ˆì§€!)
          properties:
            pgToken:
              type: string
              description: PGì‚¬ì—ì„œ ë°œê¸‰í•œ ì¹´ë“œ í† í°

    Payment:
      type: object
      properties:
        id:
          type: string
          example: "pay_999"
        orderId:
          type: string
        status:
          type: string
          enum:
            - PENDING
            - APPROVED
            - FAILED
            - CANCELLED
            - REFUNDED
        method:
          type: string
          example: "CARD"
        amount:
          type: integer
        transactionId:
          type: string
          description: PGì‚¬ ê±°ë˜ ID
          example: "pg_txn_123456"
        approvedAt:
          type: string
          format: date-time
        failReason:
          type: string
          description: ì‹¤íŒ¨ ì‚¬ìœ  (ì‹¤íŒ¨í•œ ê²½ìš°ë§Œ)

    # ============================================
    # Coupon Schemas
    # ============================================
    Coupon:
      type: object
      properties:
        id:
          type: string
        code:
          type: string
          example: "SUMMER2024"
        name:
          type: string
          example: "ì—¬ë¦„ ì‹œì¦Œ 10,000ì› í• ì¸"
        type:
          type: string
          enum:
            - FIXED_AMOUNT   # ì •ì•¡
            - PERCENTAGE     # ì •ë¥ 
            - FREE_SHIPPING  # ë°°ì†¡ë¹„ ë¬´ë£Œ
            - BUY_N_GET_1    # N+1
        discount:
          type: integer
          description: í• ì¸ ê¸ˆì•¡ ë˜ëŠ” í• ì¸ìœ¨
          example: 10000
        minOrderAmount:
          type: integer
          description: ìµœì†Œ ì£¼ë¬¸ ê¸ˆì•¡
          example: 50000
        maxDiscountAmount:
          type: integer
          description: ìµœëŒ€ í• ì¸ ê¸ˆì•¡ (ì •ë¥  ì¿ í°ì˜ ê²½ìš°)
        status:
          type: string
          enum:
            - AVAILABLE
            - USED
            - EXPIRED
        issuedAt:
          type: string
          format: date-time
        expiresAt:
          type: string
          format: date-time

    # ============================================
    # Point Schemas
    # ============================================
    PointHistory:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
          enum:
            - EARNED
            - USED
            - EXPIRED
        amount:
          type: integer
          description: í¬ì¸íŠ¸ (ì ë¦½ì€ +, ì‚¬ìš©/ì†Œë©¸ì€ -)
        description:
          type: string
          example: "ì£¼ë¬¸ êµ¬ë§¤ í™•ì • (ord_789)"
        createdAt:
          type: string
          format: date-time
        expiryDate:
          type: string
          format: date
          description: ì†Œë©¸ ì˜ˆì •ì¼

    # ============================================
    # Inventory Schemas
    # ============================================
    Inventory:
      type: object
      properties:
        sku:
          type: string
          example: "LEVI-501-BLK-32-REG"
        available:
          type: integer
          description: ê°€ìš© ì¬ê³  (íŒë§¤ ê°€ëŠ¥)
          example: 15
        reserved:
          type: integer
          description: ì˜ˆì•½ ì¬ê³  (ê²°ì œ ëŒ€ê¸°ì¤‘)
          example: 3
        physical:
          type: integer
          description: ë¬¼ë¦¬ì  ì¬ê³  (ì°½ê³  ì‹¤ì¬ê³ )
          example: 20
        safetyStock:
          type: integer
          description: ì•ˆì „ ì¬ê³  (ìµœì†Œ ìœ ì§€ ìˆ˜ëŸ‰)
          example: 2
        status:
          type: string
          enum:
            - IN_STOCK
            - LOW_STOCK
            - OUT_OF_STOCK
        lastUpdated:
          type: string
          format: date-time

    # ============================================
    # Shipment Schemas
    # ============================================
    ShipmentTracking:
      type: object
      properties:
        shipmentId:
          type: string
        orderId:
          type: string
        carrier:
          type: string
          example: "CJëŒ€í•œí†µìš´"
        trackingNumber:
          type: string
          example: "123456789012"
        status:
          type: string
          enum:
            - PREPARING
            - PICKED_UP
            - IN_TRANSIT
            - OUT_FOR_DELIVERY
            - DELIVERED
          example: "IN_TRANSIT"
        estimatedDelivery:
          type: string
          format: date
        events:
          type: array
          description: ë°°ì†¡ ì´ë²¤íŠ¸ íƒ€ì„ë¼ì¸
          items:
            type: object
            properties:
              status:
                type: string
              location:
                type: string
              timestamp:
                type: string
                format: date-time
              description:
                type: string

    # ============================================
    # Return Schemas
    # ============================================
    CreateReturnRequest:
      type: object
      required:
        - orderId
        - items
        - refundMethod
      properties:
        orderId:
          type: string
        items:
          type: array
          minItems: 1
          items:
            type: object
            required:
              - orderItemId
              - quantity
              - reason
            properties:
              orderItemId:
                type: string
              quantity:
                type: integer
                minimum: 1
              reason:
                type: string
                enum:
                  - SIZE_ISSUE
                  - DEFECTIVE
                  - WRONG_ITEM
                  - NOT_AS_DESCRIBED
                  - CHANGE_OF_MIND
                description: ë°˜í’ˆ ì‚¬ìœ 
              detailReason:
                type: string
                maxLength: 500
              images:
                type: array
                items:
                  type: string
                  format: uri
                description: ë¶ˆëŸ‰ ì‚¬ì§„ (ë¶ˆëŸ‰ì¸ ê²½ìš° í•„ìˆ˜)
        refundMethod:
          type: string
          enum:
            - ORIGINAL    # ì›ê²°ì œìˆ˜ë‹¨
            - ACCOUNT     # ê³„ì¢Œ í™˜ë¶ˆ
        bankAccount:
          type: object
          description: ê³„ì¢Œ í™˜ë¶ˆ ì‹œ í•„ìˆ˜
          properties:
            bank:
              type: string
            accountNumber:
              type: string
            holder:
              type: string

    Return:
      type: object
      properties:
        id:
          type: string
          example: "ret_111"
        orderId:
          type: string
        status:
          type: string
          enum:
            - REQUESTED
            - APPROVED
            - REJECTED
            - SHIPPING
            - RECEIVED
            - INSPECTING
            - COMPLETED
        items:
          type: array
          items:
            type: object
            properties:
              orderItemId:
                type: string
              quantity:
                type: integer
              reason:
                type: string
        returnShipping:
          type: object
          properties:
            method:
              type: string
              enum:
                - CUSTOMER_ARRANGED
                - SELLER_PICKUP
            fee:
              type: integer
              description: ë°˜í’ˆ ë°°ì†¡ë¹„
            feePaymentBy:
              type: string
              enum:
                - CUSTOMER
                - SELLER
        expectedRefund:
          type: integer
          description: ì˜ˆìƒ í™˜ë¶ˆ ê¸ˆì•¡
        createdAt:
          type: string
          format: date-time

    ReturnDetail:
      allOf:
        - $ref: '#/components/schemas/Return'
        - type: object
          properties:
            timeline:
              type: array
              items:
                type: object
                properties:
                  status:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
                  note:
                    type: string

    # ============================================
    # Exchange Schemas
    # ============================================
    CreateExchangeRequest:
      type: object
      required:
        - orderId
        - items
      properties:
        orderId:
          type: string
        items:
          type: array
          minItems: 1
          items:
            type: object
            required:
              - orderItemId
              - fromVariantId
              - toVariantId
              - reason
            properties:
              orderItemId:
                type: string
              fromVariantId:
                type: string
                description: ê¸°ì¡´ ë³€ëŸ‰ ID
              toVariantId:
                type: string
                description: êµí™˜í•  ë³€ëŸ‰ ID
              reason:
                type: string
                enum:
                  - SIZE_ISSUE
                  - COLOR_ISSUE
                  - DEFECTIVE

    Exchange:
      type: object
      properties:
        id:
          type: string
          example: "ex_222"
        orderId:
          type: string
        status:
          type: string
          enum:
            - REQUESTED
            - APPROVED
            - REJECTED
            - SHIPPING_OLD
            - OLD_RECEIVED
            - INSPECTING
            - SHIPPING_NEW
            - COMPLETED
        items:
          type: array
          items:
            type: object
            properties:
              orderItemId:
                type: string
              fromVariant:
                $ref: '#/components/schemas/ProductVariant'
              toVariant:
                $ref: '#/components/schemas/ProductVariant'
        stockStatus:
          type: string
          enum:
            - AVAILABLE
            - OUT_OF_STOCK
          description: êµí™˜ ìƒí’ˆ ì¬ê³  ìƒíƒœ
        exchangeShipping:
          type: object
          properties:
            fee:
              type: integer
            feePaymentBy:
              type: string
              enum:
                - CUSTOMER
                - SELLER
        createdAt:
          type: string
          format: date-time

    ExchangeDetail:
      allOf:
        - $ref: '#/components/schemas/Exchange'
        - type: object
          properties:
            timeline:
              type: array
              items:
                type: object
                properties:
                  status:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
                  note:
                    type: string

    # ============================================
    # Review Schemas
    # ============================================
    CreateReviewRequest:
      type: object
      required:
        - orderId
        - orderItemId
        - rating
        - content
      properties:
        orderId:
          type: string
        orderItemId:
          type: string
        rating:
          type: integer
          minimum: 1
          maximum: 5
        title:
          type: string
          maxLength: 100
        content:
          type: string
          minLength: 10
          maxLength: 1000
        images:
          type: array
          items:
            type: string
            format: uri
          maxItems: 10
          description: í¬í†  ë¦¬ë·° (ì„ íƒ)
        sizeRating:
          type: string
          enum:
            - TOO_SMALL
            - FITS_WELL
            - TOO_LARGE
          description: ì‚¬ì´ì¦ˆ í‰ê°€

    Review:
      type: object
      properties:
        id:
          type: string
        orderId:
          type: string
        orderItemId:
          type: string
        user:
          type: object
          properties:
            id:
              type: string
            name:
              type: string
            tier:
              type: string
              enum:
                - GENERAL
                - VIP
        product:
          $ref: '#/components/schemas/Product'
        variant:
          $ref: '#/components/schemas/ProductVariant'
        rating:
          type: integer
          minimum: 1
          maximum: 5
        title:
          type: string
        content:
          type: string
        images:
          type: array
          items:
            type: string
            format: uri
        sizeRating:
          type: string
          enum:
            - TOO_SMALL
            - FITS_WELL
            - TOO_LARGE
        helpfulCount:
          type: integer
          description: ë„ì›€ë¨ ìˆ˜
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    # ============================================
    # User Schemas
    # ============================================
    RegisterRequest:
      type: object
      required:
        - email
        - password
        - name
        - phone
        - agreeToTerms
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password
          minLength: 8
          description: ìµœì†Œ 8ì, ì˜ë¬¸+ìˆ«ì ì¡°í•©
        name:
          type: string
        phone:
          type: string
          pattern: '^\d{3}-\d{4}-\d{4}$'
        agreeToTerms:
          type: boolean
          description: ì´ìš©ì•½ê´€ ë™ì˜ (í•„ìˆ˜)
        agreeToMarketing:
          type: boolean
          description: ë§ˆì¼€íŒ… ìˆ˜ì‹  ë™ì˜ (ì„ íƒ)

    AuthResponse:
      type: object
      properties:
        accessToken:
          type: string
          description: JWT Access Token
        refreshToken:
          type: string
          description: JWT Refresh Token
        expiresIn:
          type: integer
          description: Access Token ë§Œë£Œ ì‹œê°„ (ì´ˆ)
          example: 3600
        user:
          $ref: '#/components/schemas/User'

    User:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
          format: email
        name:
          type: string
        phone:
          type: string
        tier:
          type: string
          enum:
            - GENERAL
            - VIP
          description: íšŒì› ë“±ê¸‰
        createdAt:
          type: string
          format: date-time

    Address:
      type: object
      required:
        - name
        - phone
        - address
        - zipCode
      properties:
        id:
          type: string
        name:
          type: string
          description: ìˆ˜ë ¹ì¸ ì´ë¦„
        phone:
          type: string
          pattern: '^\d{3}-\d{4}-\d{4}$'
          description: ì „í™”ë²ˆí˜¸
        address:
          type: string
          description: ê¸°ë³¸ ì£¼ì†Œ
        addressDetail:
          type: string
          description: ìƒì„¸ ì£¼ì†Œ
        zipCode:
          type: string
          description: ìš°í¸ë²ˆí˜¸
        isDefault:
          type: boolean
          description: ê¸°ë³¸ ë°°ì†¡ì§€ ì—¬ë¶€

    SizeProfile:
      type: object
      properties:
        height:
          type: number
          description: í‚¤ (cm)
          example: 175
        weight:
          type: number
          description: ëª¸ë¬´ê²Œ (kg)
          example: 70
        topSize:
          type: string
          description: ìƒì˜ ì‚¬ì´ì¦ˆ
          example: "L"
        bottomSize:
          type: string
          description: í•˜ì˜ ì‚¬ì´ì¦ˆ
          example: "32"
        shoeSize:
          type: number
          description: ì‹ ë°œ ì‚¬ì´ì¦ˆ (mm)
          example: 270
        preferredFit:
          type: string
          enum:
            - TIGHT
            - SLIM
            - REGULAR
            - LOOSE
          description: ì„ í˜¸ í•
        bodyType:
          type: string
          enum:
            - SLIM
            - ATHLETIC
            - AVERAGE
            - MUSCULAR
            - HEAVY
          description: ì²´í˜•

  responses:
    BadRequest:
      description: ì˜ëª»ëœ ìš”ì²­
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "BAD_REQUEST"
            message: "ìš”ì²­ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."

    Unauthorized:
      description: ì¸ì¦ í•„ìš”
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "UNAUTHORIZED"
            message: "ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”."

    Forbidden:
      description: ê¶Œí•œ ì—†ìŒ
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "FORBIDDEN"
            message: "ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."

    NotFound:
      description: ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "NOT_FOUND"
            message: "ìš”ì²­í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."

    Conflict:
      description: ì¬ê³  ë¶€ì¡± í˜¹ì€ ì¤‘ë³µ ë°ì´í„° ë°œìƒ ë“±ê³¼ ê°™ì€ ìƒí™©ì˜ ì¶©ëŒ
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "CONFLICT"
            message: "ì¬ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤."

    UnexpectedError:
      description: ì˜ˆìƒì¹˜ ëª»í•œ ì„œë²„ ì˜¤ë¥˜
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "INTERNAL_ERROR"
            message: "ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."